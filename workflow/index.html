
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="nornir_cli is CLI tool based on Nornir framework and Nornir Plugins">
      
      
        <meta name="author" content="Pavel Shemetov">
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../useful/">
      
      
      <link rel="icon" href="../None">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.1">
    
    
      
        <title>Workflow - nornir_cli</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Manrope:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Manrope";--md-code-font:"Fira Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#initializing-nornir" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="nornir_cli" class="md-header__button md-logo" aria-label="nornir_cli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            nornir_cli
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Workflow
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/timeforplanb123/nornir_cli" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    timeforplanb123/nornir_cli
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="nornir_cli" class="md-nav__button md-logo" aria-label="nornir_cli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    nornir_cli
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/timeforplanb123/nornir_cli" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    timeforplanb123/nornir_cli
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nornir_cli
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initializing-nornir" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing Nornir
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initializing Nornir">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      With configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-a-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Without a configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#both-ways" class="md-nav__link">
    <span class="md-ellipsis">
      Both ways
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Show inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Changing credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tasks-and-runbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Tasks and runbooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tasks and runbooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Single tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Result processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-about-netconf" class="md-nav__link">
    <span class="md-ellipsis">
      What about netconf?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-about-http-xlsx-jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      What about http, xlsx, jinja2?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-chains" class="md-nav__link">
    <span class="md-ellipsis">
      Command chains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runbook-collections" class="md-nav__link">
    <span class="md-ellipsis">
      Runbook collections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initializing-nornir" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing Nornir
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initializing Nornir">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      With configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-a-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Without a configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#both-ways" class="md-nav__link">
    <span class="md-ellipsis">
      Both ways
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Show inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Changing credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tasks-and-runbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Tasks and runbooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tasks and runbooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Single tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Result processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-about-netconf" class="md-nav__link">
    <span class="md-ellipsis">
      What about netconf?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-about-http-xlsx-jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      What about http, xlsx, jinja2?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-chains" class="md-nav__link">
    <span class="md-ellipsis">
      Command chains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runbook-collections" class="md-nav__link">
    <span class="md-ellipsis">
      Runbook collections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Workflow</h1>

<p><strong><code>nornir_cli</code></strong> has a workflow that is familiar to the nornir user. There is:</p>
<ul>
<li><a href="https://timeforplanb123.github.io/nornir_cli/workflow/#initializing-nornir">Initializing Nornir</a></li>
<li><a href="https://timeforplanb123.github.io/nornir_cli/workflow/#inventory">Inventory</a></li>
<li><a href="https://timeforplanb123.github.io/nornir_cli/workflow/#tasks-and-runbooks">Tasks and runbooks</a></li>
</ul>
<p>You can run a workflow as a single command or you can split it into parts </p>
<h2 id="initializing-nornir">Initializing Nornir<a class="headerlink" href="#initializing-nornir" title="Permanent link">#</a></h2>
<p>You can initialize nornir with a configuration file, with code or with a combination of both.</p>
<h4 id="with-configuration-file">With configuration file<a class="headerlink" href="#with-configuration-file" title="Permanent link">#</a></h4>
<p>Let's start with a configuration file. It is a typical Nornir configuration file.</p>
<p>By default, <code>nornir_cli</code> uses <code>config.yaml</code> in your current working directory. But you can specify path to your own configuration file with option <code>--config_file</code> or <code>-c</code>:
<div class="highlight"><pre><span></span><code># with default config.yaml in current working directory
$ nornir_cli nornir-netmiko init

# with path to config_file
$ nornir_cli nornir-netmiko init -c ~/config.yaml
</code></pre></div>
Why is <code>nornir-netmiko</code> here? <code>nornir_cli</code> runs Tasks based on Nornir plugins or your custom Nornir runbooks, so the first step is to select an available plugin or custom group (see <a href="https://timeforplanb123.github.io/nornir_cli/workflow/#runbook-collections">Runbook collections</a>).</p>
<p>For version <code>1.3.0</code>, the following Nornir plugins are available:
<div class="highlight"><pre><span></span><code>$ nornir_cli --help
Usage: nornir_cli [OPTIONS] COMMAND [ARGS]...

  Nornir CLI

  Orchestrate your Inventory and start Tasks and Runbooks

Options:
  --version  Show the version and exit.
  --help     Show this message and exit.

Commands:
  nornir-f5        nornir_f5 plugin
  nornir-http      nornir_http plugin
  nornir-jinja2    nornir_jinja2 plugin
  nornir-napalm    nornir_napalm plugin
  nornir-netconf   nornir_netconf plugin
  nornir-netmiko   nornir_netmiko plugin
  nornir-paramiko  nornir_paramiko plugin
  nornir-pyez      nornir_pyez plugin
  nornir-pyxl      nornir_pyxl plugin
  nornir-routeros  nornir_routeros plugin
  nornir-scrapli   nornir_scrapli plugin
</code></pre></div></p>
<h4 id="without-a-configuration-file">Without a configuration file<a class="headerlink" href="#without-a-configuration-file" title="Permanent link">#</a></h4>
<p>You can initialize nornir programmatically without a configuration file.</p>
<p><code>-f</code> or <code>--from_dict</code> option waits json string:</p>
<p><code>-c</code> or <code>--config_file</code> can be <code>""</code>, <code>None</code>, <code>null</code></p>
<p>Here you can pass parameters as json strings using "=" or without it. In the case of "=", the <code>nornir_cli</code> completely repeats the syntax from Nornir runbooks, and you can use the Nornir configuration patterns that are already familiar to you (or see the <a href="https://nornir.readthedocs.io/en/latest/tutorial/initializing_nornir.html" target="_blank">Nornir docs</a>). In the case without using "=", you can pass all parameters as a json string. This can be useful in scripts or automation pipelines, when using <code>nornir_cli</code> with json utilities such as <code>jq</code>, <code>jc</code>. 
This way(json string using "=" or json string without "=") you can pass parameters to initializing, filtering and Nornir plugins/tasks running processes.</p>
<p>Examples:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">json string using '=':</label><label for="__tabbed_1_2">json string:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko init -c &quot;&quot; -f &#39;inventory={&quot;plugin&quot;:&quot;NetBoxInventory2&quot;, \
&quot;options&quot;: {&quot;nb_url&quot;: &quot;http://your_netbox_domain&quot;, &quot;nb_token&quot;: &quot;your_netbox_token&quot;, \
&quot;ssl_verify&quot;: false}} runner={&quot;plugin&quot;: &quot;threaded&quot;, &quot;options&quot;: {&quot;num_workers&quot;: 50}} \
logging={&quot;enabled&quot;:true, &quot;level&quot;: &quot;DEBUG&quot;, &quot;to_console&quot;: true}&#39;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko init -c &quot;&quot; -f &#39;{&quot;inventory&quot;:{&quot;plugin&quot;:&quot;NetBoxInventory2&quot;, \
&quot;options&quot;: {&quot;nb_url&quot;: &quot;http://your_netbox_domain&quot;, &quot;nb_token&quot;: &quot;your_netbox_token&quot;, \
&quot;ssl_verify&quot;: false}}, &quot;runner&quot;:{&quot;plugin&quot;: &quot;threaded&quot;, &quot;options&quot;: {&quot;num_workers&quot;: 50}}, \
&quot;logging&quot;:{&quot;enabled&quot;:true, &quot;level&quot;: &quot;DEBUG&quot;, &quot;to_console&quot;: true}}&#39;
</code></pre></div>
</div>
</div>
</div>
<p>Or you can initialize nornir with a combination of both methods:</p>
<h4 id="both-ways">Both ways<a class="headerlink" href="#both-ways" title="Permanent link">#</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">json string using '=':</label><label for="__tabbed_2_2">the same thing, but without '=':</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko init -f &#39;runner={&quot;plugin&quot;: &quot;threaded&quot;, &quot;options&quot;: {&quot;num_workers&quot;: 50}}&#39;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko init -f &#39;{&quot;runner&quot;:{&quot;plugin&quot;: &quot;threaded&quot;, &quot;options&quot;: {&quot;num_workers&quot;: 50}}}&#39;
</code></pre></div>
</div>
</div>
</div>
<p><code>-c</code> or <code>--config_file</code> uses <code>config.yaml</code> in your current working directory, by default, so there is no <code>-c</code> option and only <code>-f</code> option here</p>
<h2 id="inventory">Inventory<a class="headerlink" href="#inventory" title="Permanent link">#</a></h2>
<p><code>nornir_cli</code> follows <code>Nornir</code> <a href="https://nornir.readthedocs.io/en/latest/tutorial/inventory.html#Filtering-the-inventory" target="_blank">filtering interface</a>.</p>
<p><code>init</code> returns <a href="https://github.com/nornir-automation/nornir/blob/e4f6b8c6258ae2dcfb286098b30652c7a31ecf30/nornir/core/__init__.py#L18" target="_blank">nornir.core.Nornir</a> object, which saved to <code>temp.pkl</code> file for future reference. <code>init</code> is enough to perform once in any way described <a href="https://timeforplanb123.github.io/nornir_cli/workflow/#initializing-nornir">above</a>. After that, you can filter inventory.</p>
<p>Now, let's take <a href="https://github.com/wvandeun/nornir_netbox" target="_blank">nornir_netbox inventory plugin</a> and do <code>init</code>, at first:</p>
<p><strong>config.yaml:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># we will use NetBox Inventory</span>
<span class="nt">inventory</span><span class="p">:</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetBoxInventory2</span>
<span class="nt">options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nb_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://your_nebox_domain&quot;</span>
<span class="w">  </span><span class="nt">nb_token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your_netbox_token&quot;</span>
<span class="w">  </span><span class="nt">ssl_verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</code></pre></div></p>
<p><strong>init:</strong>
<div class="highlight"><pre><span></span><code># -u / --username and -p / --password  will assign a username and password in defaults
# -co / --connection_options will assign options for Scrapli framework
# huawei is here just as an example
$ nornir_cli nornir-scrapli init -u username -p password -co &#39;{&quot;scrapli&quot;: {&quot;platform&quot;: &quot;huawei_vrp&quot;, &quot;extras&quot;:{&quot;ssh_config_file&quot;: true}}}&#39;
</code></pre></div></p>
<p>And now let's filter <a href="https://github.com/netbox-community/netbox" target="&quot;_blank">NetBox</a> inventory, as instance:</p>
<h4 id="filtering">Filtering<a class="headerlink" href="#filtering" title="Permanent link">#</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">simple filtering:</label><label for="__tabbed_3_2">simple filtering with json string:</label><label for="__tabbed_3_3">advanced filtering:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># let&#39;s filter current inventory and get dev_1 inventory object 
# --hosts shows filtered hosts list
$ nornir_cli nornir-scrapli filter --hosts name=dev_1
[
    &quot;dev_1&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># --inventory=host shows &quot;hosts&quot; inventory parameters for filtered hosts (dev_1 in example)
# --hosts shows filtered hosts list
# huawei is here just as an example
$ nornir_cli nornir-scrapli filter --inventory=hosts --hosts &#39;primary_ip={&quot;address&quot;: &quot;10.1.0.1/32&quot;, &quot;family&quot;: 4, &quot;id&quot;: 13, &quot;url&quot;: &quot;http://your_netbox_domain/api/ipam/ip-addresses/13/&quot;} name=dev_1&#39;

# or an alternative way(json string without &quot;=&quot;)
# $ nornir_cli nornir-scrapli filter --inventory=hosts --hosts &#39;{&quot;primary_ip&quot;:{&quot;address&quot;: &quot;10.1.0.1/32&quot;, &quot;family&quot;: 4, &quot;id&quot;: 13, &quot;url&quot;: &quot;http://your_netbox_domain/api/ipam/ip-addresses/13/&quot;}, &quot;name&quot;:&quot;dev_1&quot;}&#39;
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 13,
                &quot;name&quot;: &quot;dev_1&quot;,
                &quot;display_name&quot;: &quot;dev_1&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.1&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
    } 
}
[
    &quot;dev_1&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># --hosts shows filtered hosts list
# -a / --advanced option enables advanced filtering
$ nornir_cli nornir-scrapli filter --hosts -a &#39;name__contains=dev_1 device_role__name__contains=spine&#39;
[
    &quot;dev_1&quot;
]

# the same with &amp;
$ nornir_cli nornir-scrapli filter --hosts -a &#39;name__contains=dev_1 &amp; device_role__name__contains=spine&#39;
[
    &quot;dev_1&quot;
]

# or |
$ nornir_cli nornir-scrapli filter --hosts -a &#39;name__contains=dev_1 | name__contains=dev_2&#39;
Are you sure you want to output list of all required hosts on stdout? [Y/n]:
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
]

# another example
# --count shows the first 3 items from filtered inventory (for hosts list with --hosts option in example)
$ nornir_cli nornir-netmiko filter --hosts --count 3 -a &#39;data__device_type__model__contains=S2320-28TP-EI-DC &amp; name__contains=dev_ | data__device_type__model__contains=S2320-28TP-EI-DC &amp; name__contains=access&#39;
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
    &quot;access_1&quot;
]
</code></pre></div>
</div>
</div>
</div>
<p>By default, the filtered Inventory is not saved for future reference. It was done to perform <code>init</code> only once, and then to filter Inventory and run any commands from Nornir Plugins (see available plugins with <code>nornir_cli --help</code> command) or Nornir Runbooks (see <a href="https://timeforplanb123.github.io/nornir_cli/workflow/#runbook-collections">Runbook collections</a>) as a single command (see <a href="https://timeforplanb123.github.io/nornir_cli/workflow/#command-chains">Command chains</a>). This is useful and saves time on <code>init</code> with large inventories.</p>
<p>But, you can save the Inventory state after filtering with <code>-s</code> or <code>--save</code> option and work with new Inventory object. So any commands from Nornir Plugins or Nornir Runbooks will be run for the saved object.</p>
<p>Filter Inventory ans save it as much as needed. Perform <code>init</code> if you need to return full Inventory state again.</p>
<p>As instance, let's save Inventory after simple filtering:
<div class="highlight"><pre><span></span><code># get new inventory object with single host (dev_1)
# --hosts shows filtered and saved hosts
$ nornir_cli nornir-scrapli filter --hosts -s name=dev_1
[
    &quot;dev_1&quot;
]
</code></pre></div></p>
<p><strong>IMPORTANT:</strong> if you want to save the Inventory state after filtering for future references, please use <code>--save</code> or <code>-s</code> option.</p>
<h4 id="show-inventory">Show inventory<a class="headerlink" href="#show-inventory" title="Permanent link">#</a></h4>
<p>As you may have already noticed, it's possible to view the current inventory state with <code>show_inventory</code> command:
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli show_inventory -i hosts -h -g --count 6
# hosts inventory
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 13,
                &quot;name&quot;: &quot;dev_1&quot;,
                &quot;display_name&quot;: &quot;dev_1&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.1&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
    }
}
        ...  # there is 6 Hosts Inventory in json format
# hosts list
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
    &quot;dev_3&quot;
    &quot;dev_4&quot;
    &quot;dev_5&quot;
    &quot;access_1&quot;
]
# groups list
[]
</code></pre></div>
<code>-i</code> or <code>--inventory</code> option can be <code>hosts</code>, <code>groups</code>, <code>defaults</code> or <code>all</code>.</p>
<p><code>-cou</code> or <code>--count</code> is counter, that refers to each requested parameter.</p>
<p><code>-cou</code> or <code>--count</code> can be:</p>
<ul>
<li>
<p><code>--count -100</code> - last 100 items</p>
</li>
<li>
<p><code>--count 100</code> - first 100 items</p>
</li>
<li>
<p><code>--count 0</code> - 0 items</p>
</li>
<li>
<p>without <code>--count</code> option - all items (default value)</p>
</li>
</ul>
<p>As instance:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:4"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">to show the first 2 hosts from Inventory:</label><label for="__tabbed_4_2">to show the first 2 hosts, groups (if exist):</label><label for="__tabbed_4_3">to show the first 2 hosts and their hosts inventory:</label><label for="__tabbed_4_4">to show the first 2 hosts and all inventory:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli show_inventory -h -cou 2
# hosts list for the first 2 hosts 
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
]
</code></pre></div>
<code>-h</code> or <code>--hosts</code> option is default option, so the same is <code>nornir_cli nornir-scrapli show_inventory -cou 2</code>.</p>
<p>For the latest 2 hosts from Inventory use <code>-cou -2</code></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli show_inventory -h -g -cou 2
# hosts list for the first 2 hosts
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
]
# groups list for the first 2 groups (groups don&#39;t exist)
[]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli show_inventory -h -i hosts -cou 2
# hosts inventory for the first 2 hosts
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 13,
                &quot;name&quot;: &quot;dev_1&quot;,
                &quot;display_name&quot;: &quot;dev_1&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.1&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
        &quot;dev_2&quot;: {
            &quot;name&quot;: &quot;dev_2&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 14,
                &quot;name&quot;: &quot;dev_2&quot;,
                &quot;display_name&quot;: &quot;dev_2&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.2&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
    }
}

# hosts list for the first 2 hosts
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli show_inventory -h -i all -cou 2
# hosts inventory for the first 2 hosts
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 13,
                &quot;name&quot;: &quot;dev_1&quot;,
                &quot;display_name&quot;: &quot;dev_1&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.1&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
        &quot;dev_2&quot;: {
            &quot;name&quot;: &quot;dev_2&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {
                &quot;id&quot;: 14,
                &quot;name&quot;: &quot;dev_2&quot;,
                &quot;display_name&quot;: &quot;dev_2&quot;,
                &quot;device_type&quot;: {

            ...

            &quot;hostname&quot;: &quot;10.1.0.2&quot;,
            &quot;port&quot;: null,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: &quot;huawei&quot;
        }
    }
}
# groups inventory for the first 2 groups (groups don&#39;t exist)
{
    &quot;groups&quot;: {}
}
# defaults inventory is always 1, so counter (`-cou` or `--count`) doesn&#39;t work for it
{
    &quot;defaults&quot;: {
        &quot;data&quot;: {},
        &quot;connection_options&quot;: {},
        &quot;hostname&quot;: null,
        &quot;port&quot;: null,
        &quot;username&quot;: &quot;username&quot;,
        &quot;password&quot;: &quot;password&quot;,
        &quot;platform&quot;: null
    }
}
# hosts list for the first 2 hosts
[
    &quot;dev_1&quot;
    &quot;dev_2&quot;
]
</code></pre></div>
<code>all</code> inventory here is the first 2 hosts, groups (groups don't exist in example) and defaults inventory parameters. Counter (<code>-cou</code> or <code>--count</code>) doesn't work for defaults, because defaults is always 1.</p>
</div>
</div>
</div>
<p>And you can invoke <code>show_inventory</code> command from <code>init</code> or <code>filter</code> commands with <code>-i / --inventory</code>, <code>-h / --hosts</code>, <code>-g / --groups</code> options.</p>
<h4 id="changing-credentials">Changing credentials<a class="headerlink" href="#changing-credentials" title="Permanent link">#</a></h4>
<p>You can change credentials in any time for current Inventory with <code>change_credentials</code> command.</p>
<p>To save Inventory state for future references use <code>-s</code> or <code>--save</code> option.</p>
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli change_credentials --help
Usage: nornir_cli nornir-scrapli change_credentials [OPTIONS]

  Change username and password for current Nornir object.

  If no options are specified, the username and password will be changed for
  defaults only, as instance:

      nornir_cli nornir-scrapli change_credentials -u user -p password
      show_inventory -i defaults

  If only hosts or groups are specified (use string for single host and list
  of strings for many hosts), then the username and password will be changed
  only for them, as instance:

      nornir_cli nornir-scrapli change_credentials -u user -p password -h
      &#39;[&quot;spine_1&quot;]&#39;

  To change the username and password for all hosts or groups, use &quot;all&quot; as
  option value, as instance:

      nornir_cli nornir-scrapli change_credentials -u user -p password -h
      &quot;all&quot;

Options:
  -u, --username TEXT  Hosts, groups or defaults username
  -p, --password TEXT  Hosts, groups or defaults password
  -h, --hosts TEXT     List of hosts (json string) or single host (str)
  -g, --groups TEXT    List of groups (json string) or single group (str)
  -d, --defaults       Defaults credentials
  -s, --save           Save Nornir object with new credentials to pickle file
                       for later use
  --help               Show this message and exit.
</code></pre></div>
<p>Let's take <a href="https://github.com/wvandeun/nornir_netbox" target="_blank">nornir_netbox inventory plugin</a> and do <code>init</code>, at first:</p>
<p><strong>config.yaml:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># we will use NetBox Inventory</span>
<span class="nt">inventory</span><span class="p">:</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetBoxInventory2</span>
<span class="nt">options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nb_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://your_nebox_domain&quot;</span>
<span class="w">  </span><span class="nt">nb_token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your_netbox_token&quot;</span>
<span class="w">  </span><span class="nt">ssl_verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</code></pre></div></p>
<p><strong>init:</strong>
<div class="highlight"><pre><span></span><code># -u / --username and -p / --password  will assign a username and password in defaults
$ nornir_cli nornir-scrapli init -u username -p password
</code></pre></div></p>
<p>And now let's <code>change_credentials</code> for <code>defaults</code> Inventory and run <code>show_inventory</code> with new credentials:
<div class="highlight"><pre><span></span><code># use -s option to save Inventory with new credentials for future references
$ nornir_cli nornir-scrapli change_credentials -u user -p pass show_inventory -i defaults
{
    &quot;defaults&quot;: {
        &quot;data&quot;: {},
        &quot;connection_options&quot;: {},
        &quot;hostname&quot;: null,
        &quot;port&quot;: null,
        &quot;username&quot;: &quot;user&quot;,
        &quot;password&quot;: &quot;pass&quot;,
        &quot;platform&quot;: null
    }
}
</code></pre></div></p>
<p><code>change_credentials</code> for all <code>hosts</code> and check <code>hosts</code> Inventory with new credentials (you can do the same for <code>groups</code> Inventory):
<div class="highlight"><pre><span></span><code># use -s option to save Inventory with new credentials for future references
$ nornir_cli nornir-scrapli change_credentials -u user -p pass -h all show_inventory -i hosts
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {},
            &quot;hostname&quot;: &quot;10.3.2.1&quot;,
            &quot;port&quot;: 22,
            &quot;username&quot;: &quot;user&quot;,
            &quot;password&quot;: &quot;pass&quot;,
            &quot;platform&quot;: null
        }
        ...
        # other hosts
        ...
    }
}
</code></pre></div></p>
<p><code>change_credentials</code> for <code>hosts</code> list and check <code>hosts</code> Inventory with new credentials (you can do the same for <code>groups</code> Inventory):
<div class="highlight"><pre><span></span><code># use -s option to save Inventory with new credentials for future references
$ nornir_cli nornir-scrapli change_credentials -u username -p password -h &#39;[&quot;dev_1&quot;]&#39; show_inventory -i hosts
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {},
            &quot;hostname&quot;: &quot;10.3.2.1&quot;,
            &quot;port&quot;: 22,
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;platform&quot;: null
        }
        ...
        # other hosts with &quot;user&quot; username and &quot;password&quot; password
        ...
    }
}
</code></pre></div></p>
<p>Also, you can use <a href="https://timeforplanb123.github.io/nornir_cli/useful/#environment-variables">environment variables</a>, <code>NORNIR_CLI_USERNAME</code> and <code>NORNIR_CLI_PASSWORD</code>:
<div class="highlight"><pre><span></span><code>$ export NORNIR_CLI_USERNAME=user
$ export NORNIR_CLI_PASSWORD=pass

# use -s option to save Inventory with new credentials for future references
$ nornir_cli nornir-scrapli change_credentials -h &#39;[&quot;dev_1&quot;]&#39; show_inventory -i hosts
{
    &quot;hosts&quot;: {
        &quot;dev_1&quot;: {
            &quot;name&quot;: &quot;dev_1&quot;,
            &quot;connection_options&quot;: {},
            &quot;groups&quot;: [],
            &quot;data&quot;: {},
            &quot;hostname&quot;: &quot;10.3.2.1&quot;,
            &quot;port&quot;: 22,
            &quot;username&quot;: &quot;user&quot;,
            &quot;password&quot;: &quot;pass&quot;,
            &quot;platform&quot;: null
        }
        ...
        # other hosts with &quot;user&quot; username and &quot;password&quot; password
        ...
    }
}
</code></pre></div></p>
<h2 id="tasks-and-runbooks">Tasks and runbooks<a class="headerlink" href="#tasks-and-runbooks" title="Permanent link">#</a></h2>
<p><strong>I must say that each argument or option parameter can be passed to the Task as a json string. It's important.</strong></p>
<h4 id="single-tasks">Single tasks<a class="headerlink" href="#single-tasks" title="Permanent link">#</a></h4>
<p>Ok, now we have filtered inventory for <code>dev_1</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">config.yaml:</label><label for="__tabbed_5_2">init:</label><label for="__tabbed_5_3">simple filtering:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># we will use NetBox Inventory</span>
<span class="nt">inventory</span><span class="p">:</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetBoxInventory2</span>
<span class="nt">options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nb_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://your_nebox_domain&quot;</span>
<span class="w">  </span><span class="nt">nb_token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your_netbox_token&quot;</span>
<span class="w">  </span><span class="nt">ssl_verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># -u / --username and -p / --password  will assign a username and password in defaults
# -co / --connection_options will assign options for Scrapli framework
# huawei is here just as an example
$ nornir_cli nornir-scrapli init -u username -p password -co &#39;{&quot;scrapli&quot;: {&quot;platform&quot;: &quot;huawei_vrp&quot;, &quot;extras&quot;:{&quot;ssh_config_file&quot;: true}}}&#39;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># let&#39;s filter current inventory, get dev_1 inventory object and save it
# --hosts shows filtered hosts list
$ nornir_cli nornir-scrapli filter --hosts -s name=dev_1

# or an alternative way(json string)
# $ nornir_cli nornir-scrapli filter --hosts -s &#39;{&quot;name&quot;:&quot;dev_1&quot;}&#39;
[
    &quot;dev_1&quot;
]
</code></pre></div>
</div>
</div>
</div>
<p>And let's start some Task based on Nornir plugins:</p>
<p>At first, let's check all available Tasks/commands for current list of Nornir plugins:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:11"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><input id="__tabbed_6_3" name="__tabbed_6" type="radio" /><input id="__tabbed_6_4" name="__tabbed_6" type="radio" /><input id="__tabbed_6_5" name="__tabbed_6" type="radio" /><input id="__tabbed_6_6" name="__tabbed_6" type="radio" /><input id="__tabbed_6_7" name="__tabbed_6" type="radio" /><input id="__tabbed_6_8" name="__tabbed_6" type="radio" /><input id="__tabbed_6_9" name="__tabbed_6" type="radio" /><input id="__tabbed_6_10" name="__tabbed_6" type="radio" /><input id="__tabbed_6_11" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">norir-netmiko:</label><label for="__tabbed_6_2">nornir-scrapli:</label><label for="__tabbed_6_3">nornir-napalm:</label><label for="__tabbed_6_4">nornir-jinja2:</label><label for="__tabbed_6_5">nornir-pyez:</label><label for="__tabbed_6_6">nornir-f5:</label><label for="__tabbed_6_7">nornir-paramiko:</label><label for="__tabbed_6_8">nornir-http:</label><label for="__tabbed_6_9">nornir-pyxl:</label><label for="__tabbed_6_10">nornir-netconf:</label><label for="__tabbed_6_11">nornir-routeros</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko
Usage: nornir_cli nornir-netmiko [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                                 [ARGS]...]...

  nornir_netmiko plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials     Change username and password
  filter                 Do simple or advanced filtering
  init                   Initialize a Nornir
  netmiko_commit         Execute Netmiko commit method
  netmiko_file_transfer  Execute Netmiko file_transfer method
  netmiko_multiline      Execute Netmiko send_multiline method (or
                         send_multiline_timing)
  netmiko_save_config    Execute Netmiko save_config method
  netmiko_send_command   Execute Netmiko send_command method (or
                         send_command_timing)
  netmiko_send_config    Execute Netmiko send_config_set method (or
                         send_config_from_file)
  print_result           print_result from nornir_utils
  show_inventory         Show current inventory
  write_file             Write_file, but not from nornir_utils
  write_result           Write `Result` object to file
  write_results          Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli
Usage: nornir_cli nornir-scrapli [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                             [ARGS]...]...

  nornir_scrapli plugin

Options:
  --help  Show this message and exit.

Commands:
  cfg_abort_config         Abort a device candidate config with scrapli-cfg
  cfg_commit_config        Commit a device candidate config with scrapli-cfg
  cfg_diff_config          Diff a device candidate config vs a source config
                           with scrapli-cfg
  cfg_get_config           Get device config with scrapli-cfg
  cfg_get_version          Get device version with scrapli-cfg
  cfg_load_config          Load device config with scrapli-cfg
  change_credentials       Change username and password
  filter                   Do simple or advanced filtering
  get_prompt               Get current prompt from device using scrapli
  init                     Initialize a Nornir
  netconf_capabilities     Retrieve the device config with scrapli_netconf
  netconf_commit           Commit the device config with scrapli_netconf
  netconf_delete_config    Send a &quot;delete-config&quot; rcp to the device with
                           scrapli_netconf
  netconf_discard          Discard the device config with scrapli_netconf
  netconf_edit_config      Edit config from the device with scrapli_netconf
  netconf_get              Get from the device with scrapli_netconf
  netconf_get_config       Get config from the device with scrapli_netconf
  netconf_lock             Lock the device with scrapli_netconf
  netconf_rpc              Send a &quot;bare&quot; rcp to the device with
                           scrapli_netconf
  netconf_unlock           Unlock the device with scrapli_netconf
  netconf_validate         Send a &quot;validate&quot; rcp to the device with
                           scrapli_netconf
  print_result             print_result from nornir_utils
  send_command             Send a single command to device using scrapli
  send_commands            Send a list of commands to device using scrapli
  send_commands_from_file  Send a list of commands from a file to device using
                           scrapli
  send_config              Send a config to device using scrapli
  send_configs             Send configs to device using scrapli
  send_configs_from_file   Send configs from a file to device using scrapli
  send_interactive         Send inputs in an interactive fashion using
                           scrapli; usually used to handle prompts
  show_inventory           Show current inventory
  write_file               Write_file, but not from nornir_utils
  write_result             Write `Result` object to file
  write_results            Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-napalm
Usage: nornir_cli nornir-napalm [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                            [ARGS]...]...

  nornir_napalm plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  filter              Do simple or advanced filtering
  init                Initialize a Nornir
  napalm_cli          Run commands on remote devices using napalm
  napalm_configure    Loads configuration into a network devices using napalm
  napalm_get          Gather information from network devices using napalm
  napalm_ping         Executes ping on the device and returns a dictionary
                      with the result
  napalm_validate     Gather information with napalm and validate it
  print_result        print_result from nornir_utils
  show_inventory      Show current inventory
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-jinja2
Usage: nornir_cli nornir-jinja2 [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                            [ARGS]...]...

  nornir_jinja2 plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  filter              Do simple or advanced filtering
  init                Initialize a Nornir
  print_result        print_result from nornir_utils
  show_inventory      Show current inventory
  template_file       Renders contants of a file with jinja2. All the host
                      data is available in the template
  template_string     Renders a string with jinja2. All the host data is
                      available in the template
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-pyez
Usage: nornir_cli nornir-pyez [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                              [ARGS]...]...

  nornir_pyez plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials             Change username and password
  filter                         Do simple or advanced filtering
  init                           Initialize a Nornir
  print_result                   print_result from nornir_utils
  pyez_chassis_inventory
  pyez_checksum
  pyez_cmd
  pyez_commit
  pyez_config
  pyez_diff
  pyez_facts
  pyez_get_arp
  pyez_get_config
  pyez_get_int_optics_diag_info
  pyez_int_terse
  pyez_rollback
  pyez_route_info
  pyez_rpc
  pyez_scp
  pyez_sec_ike
  pyez_sec_ipsec
  pyez_sec_nat_dest
  pyez_sec_nat_src
  pyez_sec_policy
  pyez_sec_zones
  show_inventory                 Show current inventory
  write_file                     Write_file, but not from nornir_utils
  write_result                   Write `Result` object to file
  write_results                  Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-f5
Usage: nornir_cli nornir-f5 [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                            [ARGS]...]...

  nornir_f5 plugin

Options:
  --help  Show this message and exit.

Commands:
  atc                             Task to deploy declaratives on F5 devices
  atc_info                        Task to verify if ATC service is available
                                  and collect service info
  bigip_cm_config_sync            Task to synchronize the configuration
                                  between devices
  bigip_cm_failover_status        Task to get the failover status of the
                                  device
  bigip_cm_sync_status            Task to get the synchronization status of
                                  the device
  bigip_shared_file_transfer_uploads
                                  Upload a file to a BIG-IP system using the
                                  iControl REST API
  bigip_shared_iapp_lx_package    Task to manage Javascript LX packages on a
                                  BIG-IP
  bigip_sys_version               Gets the system version of the BIG-IP
  bigip_util_unix_ls              Task to list information about the FILEs
  bigip_util_unix_rm              Task to delete a file from a BIG-IP system
  change_credentials              Change username and password
  filter                          Do simple or advanced filtering
  init                            Initialize a Nornir
  print_result                    print_result from nornir_utils
  show_inventory                  Show current inventory
  write_file                      Write_file, but not from nornir_utils
  write_result                    Write `Result` object to file
  write_results                   Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-paramiko
Usage: nornir_cli nornir-paramiko [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                                  [ARGS]...]...

  nornir_paramiko plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  filter              Do simple or advanced filtering
  init                Initialize a Nornir
  paramiko_command    Executes a command remotely on the host
  paramiko_sftp       Transfer files from/to the device using sftp protocol
  print_result        print_result from nornir_utils
  show_inventory      Show current inventory
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-http
Usage: nornir_cli nornir-http [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                              [ARGS]...]...

  nornir_http plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  filter              Do simple or advanced filtering
  http_method         This is a helper task that uses `httpx
                      &lt;https://www.python-httpx.org/api/&gt;`_ to interact with
                      an HTTP server
  init                Initialize a Nornir
  print_result        print_result from nornir_utils
  show_inventory      Show current inventory
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-pyxl
Usage: nornir_cli nornir-pyxl [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                              [ARGS]...]...

  nornir_pyxl plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  filter              Do simple or advanced filtering
  init                Initialize a Nornir
  print_result        print_result from nornir_utils
  pyxl_ez_data        Loads a specific sheet from a workbook(xlsx file)
  show_inventory      Show current inventory
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netconf
Usage: nornir_cli nornir-netconf [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                                 [ARGS]...]...

  nornir_netconf plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials    Change username and password
  filter                Do simple or advanced filtering
  init                  Initialize a Nornir
  netconf_capabilities  Gather Netconf capabilities from device
  netconf_commit        Commit operation
  netconf_edit_config   Edit configuration of device using Netconf
  netconf_get           Get information over Netconf from device
  netconf_get_config    Get configuration over Netconf from device
  netconf_get_schemas   Fetch provided schemas and write to a file
  netconf_lock          NETCONF locking operations for a specified datastore
  print_result          print_result from nornir_utils
  show_inventory        Show current inventory
  write_file            Write_file, but not from nornir_utils
  write_result          Write `Result` object to file
  write_results         Write `Result` object to files
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>Usage: nornir_cli nornir-routeros [OPTIONS] COMMAND1 [ARGS]... [COMMAND2
                                  [ARGS]...]...

  nornir_routeros plugin

Options:
  --help  Show this message and exit.

Commands:
  change_credentials    Change username and password
  filter                Do simple or advanced filtering
  init                  Initialize a Nornir
  print_result          print_result from nornir_utils
  routeros_command      Runs a RouterOS command such as ping or fetch
  routeros_config_item  Configures an item
  routeros_get          Returns a RouterOS resource
  show_inventory        Show current inventory
  write_file            Write_file, but not from nornir_utils
  write_result          Write `Result` object to file
  write_results         Write `Result` object to files
</code></pre></div>
</div>
</div>
</div>
<p>And start <code>netmiko_send_command</code>, for example:</p>
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko netmiko_send_command --command_string &quot;display clock&quot;

# or using json string as command argument
# $ nornir_cli nornir-netmiko netmiko_send_command &#39;{&quot;command_string&quot;:&quot;display clock&quot;}&#39;
netmiko_send_command************************************************************
* dev_1 ** changed : False *****************************************************
vvvv netmiko_send_command ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
2021-03-19 12:57:11+03:00
Friday
Time Zone(Moscow) : UTC+03:00
^^^^ END netmiko_send_command ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

dev_1            : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0
</code></pre></div>
<p>Before, we added connection options for scrapli in <code>init</code> command.
Let's check out some <code>nornir-scrapli</code> command:</p>
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli send_command --command &quot;display clock&quot;

# or using json string as command argument
# $ nornir_cli nornir-scrapli send_command &#39;{&quot;command&quot;:&quot;display clock&quot;}&#39;
send_command********************************************************************
* dev_1 ** changed : False *****************************************************
vvvv send_command ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
2021-03-19 13:18:53+03:00
Friday
Time Zone(Moscow) : UTC+03:00
^^^^ END send_command ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

dev_1            : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0
</code></pre></div>
<p>As you may have noticed, there is a result and statistic in the output above. There are options <code>--print_result</code> and <code>--print_stat</code> for this. Options <code>--no_print_result</code> and <code>--no_print_stat</code> disable it.</p>
<p><code>nornir-scrapli send_command</code> options, as instance:
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli send_command --help
Usage: nornir_cli nornir-scrapli send_command [OPTIONS] [ARGUMENTS]

  Send a single command to device using scrapli

      Args:

          command: string to send to device in privilege exec mode

          strip_prompt: True/False strip prompt from returned output

          failed_when_contains: string or list of strings indicating failure
          if found in response

          timeout_ops: timeout ops value for this operation; only sets the
          timeout_ops value for the duration of the operation, value is reset
          to initial value after operation is completed

      Returns: nornir Result attributes(optional), statistic, progress
      bar(optional)

Options:
  --pg_bar                        Progress bar flag
  --print_result / --no_print_result
                                  print_result from nornir_utils  [default:
                                  print_result]
  --print_stat / --no_print_stat  Print Result statistic for Nornir object
                                  [default: print_stat]
  --command TEXT                  [required]
  --strip_prompt BOOLEAN          [default: True]
  --failed_when_contains TEXT     [default: None]
  --timeout_ops TEXT              [default: None]
  --help                          Show this message and exit.
</code></pre></div></p>
<p>The examples above show 2 ways to pass parameters to the command:
- using the command option:
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko netmiko_send_command --command_string &quot;display clock&quot;
</code></pre></div>
- using a json string argument:
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netmiko netmiko_send_command &#39;{&quot;command_string&quot;:&quot;display clock&quot;}&#39;
# or
$ nornir_cli nornir-netmiko netmiko_send_command &#39;command_string=display clock&#39;
# or
$ nornir_cli nornir-netmiko netmiko_send_command &#39;&quot;command_string&quot;=&quot;display clock&quot;&#39;
</code></pre></div></p>
<p>When using options and arguments at the same time, the priority of options will be higher. For example, <code>nornir_cli nornir-netmiko netmiko_send_command --command_string "disp ver" '{"command_string":"disp clock"}'</code> will send <code>disp ver</code> command to device.</p>
<h4 id="result-processing">Result processing<a class="headerlink" href="#result-processing" title="Permanent link">#</a></h4>
<p><strong>print_result</strong></p>
<p>As you can see, you can disable default option <code>--print_result</code>, <code>--print_stat</code> and use <code>print_result</code> command instead of these. </p>
<p><code>--print_result</code> option uses default arguments, but <code>print_result</code> command allows you to customize the output. You can output <a href="https://github.com/nornir-automation/nornir/blob/2e0c9f4e8997f05ac60e94956faa6443302133d4/nornir/core/task.py#L185" target="_blank"><code>class Result</code></a> attributes, limit results with <code>--count</code> option, print statistic with <code>--print_stat</code> option, etc. </p>
<p>Let's see <code>print_result</code> options and run it:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">print_result options:</label><label for="__tabbed_7_2">run print_result:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli print_result --help
Usage: nornir_cli nornir-scrapli print_result [OPTIONS]

  print_result from nornir_utils

Options:
  -ph, --print_host BOOLEAN       Print hostnames  [default: True]
  -attrs, --attributes TEXT       Result class attributes you want to print
  -ps, --print_stat / -no_ps, --no_print_stat
                                  Print Result statistic for Nornir object
                                  [default: no_ps]
  -cou, --count INTEGER           Results counter
  -sl, --severity_level [CRITICAL|ERROR|WARNING|INFO|DEBUG|NOTSET]
                                  Show only errors with this severity level or
                                  higher  [default: INFO]
  --failed BOOLEAN                If True assume the task failed  [default:
                                  False]
  --help                          Show this message and exit.
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli send_command --command &quot;disp clock&quot; --no_print_result --no_print_stat print_result -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39; -ps

# or using json string as command argument
# please note that the arguments must be specified after the options
# $ nornir_cli nornir-scrapli send_command --no_print_result --no_print_stat &#39;{&quot;command&quot;:&quot;disp clock&quot;}&#39; print_result -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39; -ps
send_command********************************************************************
* dev_1 ** changed : False *****************************************************
vvvv send_command ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
2021-10-03 16:40:06+03:00
Sunday
Time Zone(Moscow) : UTC+03:00
^^^^ END send_command ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
dev_1         : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0

# send_command doesn&#39;t have &quot;diff&quot; attribute, so it&#39;s not displayed
</code></pre></div>
</div>
</div>
</div>
<p><strong>write_result and write_results</strong></p>
<p>Result can be written to a file using <code>write_result</code> command for all hosts from current Inventory. </p>
<p>By default, <code>write_result</code>  tries to create a file in the current directory or in the specified directory, if file doesn't exist.</p>
<p><code>write_result</code> command has many options. For example, you can exclude errors from a file, write "diff" to another file or output it, use different write modes, limit entries number, etc.</p>
<p>If you want to see which hosts have completed the task with an error, but do not add errors to the files, use <code>--no_errors</code> or <code>-ne</code> with <code>--print_stat</code> or <code>-ps</code> option.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">write_result options:</label><label for="__tabbed_8_2">run write_result and print_stat:</label><label for="__tabbed_8_3">test.txt:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli write_result --help
Usage: nornir_cli nornir-scrapli write_result [OPTIONS]

  Write an object of type `nornir.core.task.Result` to file

Options:
  -f, --filename TEXT             File you want to write into  [required]
  -ne, --no_errors                Do not write errors to file  [default:
                                  False]
  -wh, --write_host BOOLEAN       Write hostnames  [default: True]
  -dtf, --diff_to_file PATH       Write diff to file
  -pd, --print_diff / -no_pd, --no_print_diff
                                  Print diff  [default: no_pd]
  -a, --append                    Whether you want to replace the contents or
                                  append to it  [default: False]
  -attrs, --attributes TEXT       Result attributes you want to write (str or
                                  list(json string)). There can be any Result
                                  attributes or text. By default, the result
                                  attribute is used
  -ps, --print_stat / -no_ps, --no_print_stat
                                  Print Result statistic for Nornir object
                                  [default: no_ps]
  -cou, --count INTEGER           Results counter
  -sl, --severity_level [CRITICAL|ERROR|WARNING|INFO|DEBUG|NOTSET]
                                  Show only errors with this severity level or
                                  higher  [default: INFO]
  --failed BOOLEAN                If True assume the task failed  [default:
                                  False]
  --help                          Show this message and exit.
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli send_command --command &quot;disp clock&quot; --no_print_result --no_print_stat write_result -f test.txt -ne -ps -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39;

# or using json string as command argument
# please note that the arguments must be specified after the options
# $ nornir_cli nornir-scrapli send_command --no_print_result --no_print_stat &#39;{&quot;command&quot;:&quot;disp clock&quot;}&#39; write_result -f test.txt -ne -ps -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39;
dev_1         : ok=1               changed=0               failed=0              

OK      : 1
CHANGED : 0
FAILED  : 0

# send_command doesn&#39;t have &quot;diff&quot; attribute, so it&#39;s not displayed
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>vvvv dev_1: ** send_command ** changed : False  INFO

2021-10-03 17:03:41+03:00
Sunday
Time Zone(Moscow) : UTC+03:00
</code></pre></div>
</div>
</div>
</div>
<p>Result can be written to a files with hostnames as filenames using <code>write_results</code> command for all hosts from current Inventory. For example, it is usefull for diagnostic commands, that run many <code>show something</code> or <code>display something</code> commands.</p>
<p>By default, <code>write_results</code>  tries to create a specified directory, if it doesn't exist.</p>
<p><code>write_results</code> command has the same options as <code>write_result</code>, but uses <code>-d</code> or <code>--dirname</code> instead of <code>-f</code> or <code>--filename</code>.</p>
<p>If you want to see which hosts have completed the task with an error, but do not add errors to the files, use <code>--no_errors</code> or <code>-ne</code> with <code>--print_stat</code> or <code>-ps</code> option.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:3"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">write_results options:</label><label for="__tabbed_9_2">run write_results and print_stat:</label><label for="__tabbed_9_3">test/dev_1:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli write_results --help
Usage: nornir_cli nornir-scrapli write_results [OPTIONS]

  Write an object of type `nornir.core.task.Result` to files with hostname
  names

Options:
  -d, --dirname TEXT              Direcotry you want to write into  [required]
  -ne, --no_errors                Do not write errors to file  [default:
                                  False]
  -wh, --write_host BOOLEAN       Write hostnames  [default: True]
  -dtf, --diff_to_file PATH       Write diff to file
  -pd, --print_diff / -no_pd, --no_print_diff
                                  Print diff  [default: no_pd]
  -a, --append                    Whether you want to replace the contents or
                                  append to it  [default: False]
  -attrs, --attributes TEXT       Result attributes you want to write (str or
                                  list(json string)). There can be any Result
                                  attributes or text. By default, the result
                                  attribute is used
  -ps, --print_stat / -no_ps, --no_print_stat
                                  Print Result statistic for Nornir object
                                  [default: no_ps]
  -cou, --count INTEGER           Results counter
  -sl, --severity_level [CRITICAL|ERROR|WARNING|INFO|DEBUG|NOTSET]
                                  Show only errors with this severity level or
                                  higher  [default: INFO]
  --failed BOOLEAN                If True assume the task failed  [default:
                                  False]
  --help                          Show this message and exit.
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli send_command --command &quot;disp clock&quot; --no_print_result --no_print_stat write_results -d test -ne -ps -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39;

# or using json string as command argument
# please note that the arguments must be specified after the options
# $ nornir_cli nornir-scrapli send_command --no_print_result --no_print_stat &#39;{&quot;command&quot;:&quot;disp clock&quot;}&#39; write_results -d test -ne -ps -attrs &#39;[&quot;result&quot;, &quot;diff&quot;]&#39;
dev_1         : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0

# send_command doesn&#39;t have &quot;diff&quot; attribute, so it&#39;s not displayed
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>vvvv dev_1 ** send_command ** changed : False  INFO

2021-10-03 17:28:57+03:00
Sunday
Time Zone(Moscow) : UTC+03:00
</code></pre></div>
</div>
</div>
</div>
<p><strong>write_file</strong></p>
<p><code>write_file</code> command writes any text to a file with the required number of indents. So you can add some useful data to previously generated file <code>test.txt</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">write_file options:</label><label for="__tabbed_10_2">run write_file:</label><label for="__tabbed_10_3">test.txt:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli write_file --help
Usage: nornir_cli nornir-scrapli write_file [OPTIONS]

  Write_file, but not from nornir_utils

Options:
  -l, --line_feed      number of \n before text  [default: 0;x&gt;=0]
  -a, --append         Whether you want to replace the contents or append to
                       it  [default: False]
  -c, --content TEXT   Content you want to write (string)  [required]
  -f, --filename TEXT  File you want to write into  [required]
  --help               Show this message and exit.
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli write_file -lll -a -c &quot;some useful data&quot; -f test.txt
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>vvvv dev_1 ** send_command ** changed : False  INFO

2021-10-03 17:03:41+03:00
Sunday
Time Zone(Moscow) : UTC+03:00


some useful data
</code></pre></div>
</div>
</div>
</div>
<h4 id="what-about-netconf">What about netconf?<a class="headerlink" href="#what-about-netconf" title="Permanent link">#</a></h4>
<p>If some devices support netconf, you can use <code>nornir-scrapli</code>, <code>nornir-netconf</code> or <code>nornir-pyez</code> Nornir plugins from <code>nornir_cli</code>.</p>
<p><a href="https://timeforplanb123.github.io/nornir_cli/useful/#how-to-craft-xml-from-yang">Here is easy way to get xml tree from yang</a></p>
<p>As instance,<code>dev_3</code> understands netconf XML. Let's get <code>nornir.core.Nornir</code> object for <code>dev_3</code> and run some netconf command with nornir-scrapli and nornir-netconf:</p>
<p><strong>nornir-scrapli:</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">get Nornir object for dev_3:</label><label for="__tabbed_11_2">nornir-scrapli:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli init -u username -p password -co &#39;{&quot;scrapli&quot;: {&quot;platform&quot;: &quot;huawei_vrp&quot;, &quot;extras&quot;:{&quot;ssh_config_file&quot;: true}}}&#39; filter --hosts -s &#39;name=dev_3&#39;
[
    &quot;dev_3&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli netconf_get --filter_=&#39;&lt;ifm xmlns=&quot;http://www.huawei.com/netconf/vrp/huawei-ifm&quot;&gt;&lt;interfaces&gt;&lt;interface&gt;&lt;ifName/&gt;&lt;/interface&gt;&lt;/interfaces&gt;&lt;/ifm&gt;&#39; --filter_type subtree

# or
# $ nornir_cli nornir-scrapli netconf_get --filter_ &#39;&lt;ifm xmlns=&quot;http://www.huawei.com/netconf/vrp/huawei-ifm&quot;&gt;&lt;interfaces&gt;&lt;interface&gt;&lt;ifName/&gt;&lt;/interface&gt;&lt;/interfaces&gt;&lt;/ifm&gt;&#39; --filter_type subtree

...
netconf_get*********************************************************************
* dev_3 ** changed : False *****************************************************
vvvv netconf_get ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
&lt;rpc-reply xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot; message-id=&quot;101&quot;&gt;
  &lt;data&gt;
    &lt;ifm xmlns=&quot;http://www.huawei.com/netconf/vrp/huawei-ifm&quot;&gt;
      &lt;interfaces&gt;
        &lt;interface&gt;
          &lt;ifIndex&gt;1&lt;/ifIndex&gt;
          &lt;ifName&gt;Virtual-Template0&lt;/ifName&gt;
        &lt;/interface&gt;

        ...

        &lt;interface&gt;
          &lt;ifIndex&gt;717&lt;/ifIndex&gt;
          &lt;ifName&gt;GigabitEthernet4/1/1.514&lt;/ifName&gt;
        &lt;/interface&gt;
      &lt;/interfaces&gt;
    &lt;/ifm&gt;
  &lt;/data&gt;
&lt;/rpc-reply&gt;

^^^^ END netconf_get ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

dev_3                                        : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0
</code></pre></div>
</div>
</div>
</div>
<p><strong>nornir-netconf with write_result command:</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:3"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">get Nornir object for dev_3:</label><label for="__tabbed_12_2">nornir-netconf:</label><label for="__tabbed_12_3">netconf.txt:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>nornir_cli nornir-netconf init -u username -p password -c None -co &#39;{&quot;netconf&quot;: {&quot;extras&quot;:{&quot;allow_agent&quot;: false, &quot;look_for_keys&quot;: false, &quot;hostkey_verify&quot;: false}}}&#39; -f &#39;inventory={&quot;plugin&quot;:&quot;NetBoxInventory2&quot;, &quot;options&quot;: {&quot;nb_url&quot;: &quot;http://your_netbox_domain&quot;, &quot;nb_token&quot;: &quot;your_netbox_token&quot;, &quot;ssl_verify&quot;: false}} runner={&quot;plugin&quot;: &quot;threaded&quot;, &quot;options&quot;: {&quot;num_workers&quot;: 50}}&#39;

$ nornir_cli nornir-netconf filter -s &#39;name=dev_3&#39;
[
   &quot;dev_3&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-netconf netconf_get --path &#39;&lt;ifm xmlns=&quot;http://www.huawei.com/netconf/vrp/huawei-ifm&quot; content-version=&quot;1.0&quot; format-version=&quot;1.0&quot;&gt;  &lt;interfaces&gt;    &lt;interface&gt;      &lt;ifName/&gt;    &lt;/interface&gt;  &lt;/interfaces&gt;&lt;/ifm&gt;&#39; --filter_type subtree  --no_print_result --no_print_stat write_result -f netconf.txt
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>vvvv dev_3: netconf_get ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO

{&#39;error&#39;: None, &#39;errors&#39;: [], &#39;ok&#39;: True, &#39;rpc&#39;: &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;rpc-reply message-id=&quot;urn:uuid:3&quot; xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
  &lt;data&gt;
    &lt;ifm xmlns=&quot;http://www.huawei.com/netconf/vrp/huawei-ifm&quot;&gt;
      &lt;interfaces&gt;
        &lt;interface&gt;
          &lt;ifName&gt;Virtual-Template0&lt;/ifName&gt;
        &lt;/interface&gt;
        &lt;interface&gt;
          &lt;ifName&gt;NULL0&lt;/ifName&gt;
        &lt;/interface&gt;
        &lt;interface&gt;
          &lt;ifName&gt;GigabitEthernet0/0/0&lt;/ifName&gt;
        &lt;/interface&gt;
        ...
        &lt;/interfaces&gt;
    &lt;/ifm&gt;
  &lt;/data&gt;
&lt;/rpc-reply&gt;}
</code></pre></div>
</div>
</div>
</div>
<h4 id="what-about-http-xlsx-jinja2">What about http, xlsx, jinja2?<a class="headerlink" href="#what-about-http-xlsx-jinja2" title="Permanent link">#</a></h4>
<p><code>nornir_cli</code> includes <code>nornir-http</code>, <code>nornir-pyxl</code>, <code>nornir-jinja2</code> Nornir plugins. </p>
<p>Remember that when using these plugins, each command is run for each host from the Inventory. Therefore, if you need to process <code>xlsx</code>, execute <code>http request</code> or get a single <code>jinja2</code> template without binding to devices, then run the command from the Nornir plugin for one device from the Inventory. </p>
<p>See <a href="https://timeforplanb123.github.io/nornir_cli/examples/">examples</a></p>
<h4 id="command-chains">Command chains<a class="headerlink" href="#command-chains" title="Permanent link">#</a></h4>
<p>And, of course, you can run any command chains, even very scary ones. For <code>nornir_cli</code> version <code>&lt;= 1.2.0</code>, you can use the following syntax:</p>
<div class="highlight"><pre><span></span><code>$ nornir_cli nornir-scrapli init -u username -p password \
-co &#39;{&quot;scrapli&quot;: {&quot;platform&quot;: &quot;huawei_vrp&quot;, &quot;extras&quot;:{&quot;ssh_config_file&quot;: true}}}&#39; \
filter --hosts -s &#39;name=dev_1&#39; send_command --command &quot;display clock&quot; \
send_interactive --interact_events &#39;[[&quot;save&quot;, &quot;Are you sure to continue?[Y/N]&quot;, false], \
[&quot;Y&quot;, &quot;Save the configuration successfully.&quot;, true]]&#39;
</code></pre></div>
<p>For <code>nornir_cli</code> version <code>&gt;= 1.3.0</code>, you can use only json strings as an argument:</p>
<div class="highlight"><pre><span></span><code># $ nornir_cli nornir-scrapli init -u username -p password \
-co &#39;{&quot;scrapli&quot;: {&quot;platform&quot;: &quot;huawei_vrp&quot;, &quot;extras&quot;:{&quot;ssh_config_file&quot;: true}}}&#39; \
filter --hosts -s &#39;{&quot;name&quot;:&quot;dev_1&quot;}&#39; send_command &#39;{&quot;command&quot;:&quot;display clock&quot;}&#39; \
send_interactive &#39;{&quot;interact_events&quot;:[[&quot;save&quot;, &quot;Are you sure to continue?[Y/N]&quot;, false], \
[&quot;Y&quot;, &quot;Save the configuration successfully.&quot;, true]]}&#39;
[
    &quot;dev_1&quot;
]

send_command********************************************************************
* dev_1 ** changed : False *****************************************************
vvvv send_command ** changed : False vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
2021-03-19 14:12:38+03:00
Friday
Time Zone(Moscow) : UTC+03:00
^^^^ END send_command ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

dev_1            : ok=1               changed=0               failed=0

OK      : 1
CHANGED : 0
FAILED  : 0

send_interactive****************************************************************
* dev_1 ** changed : True ******************************************************
vvvv send_interactive ** changed : True vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv INFO
^^^^ END send_interactive ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

dev_1            : ok=1               changed=1               failed=0

OK      : 1
CHANGED : 1
FAILED  : 0
</code></pre></div>
<p><strong>Again, i repeat that each argument can be passed to the Task as a json string.</strong></p>
<h4 id="runbook-collections">Runbook collections<a class="headerlink" href="#runbook-collections" title="Permanent link">#</a></h4>
<p>If you solve some automation tasks with the Nornir, then you, probably, have Nornir runbooks.You can use <code>nornir_cli</code> as interface for manage these Nornir runbooks.</p>
<p>Create any directory trees in the <code>custom_commands</code> directory and put your Nornir runbooks there, following the simple rules. Then run them for any hosts from CLI, managing your inventory with <code>nornir_cli</code>. This is very similar to <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html" target="_blank"><code>Ansible Roles</code></a>.</p>
<p>Let's create a collection of your Nornir runbooks using <code>nornir_cli</code>. </p>
<p>For example, I have <a href="https://timeforplanb123.github.io/nornir_cli/examples/#custom-nornir-runbooks">Nornir runbook called <code>"cmd_dhcp_snooping.py"</code></a>, and I want to add it to a <code>dhcp</code> group in <code>nornir_cli</code>. 
Then, my directory tree:</p>
<div class="highlight"><pre><span></span><code>$ tree ~/virtenvs/py3.8.4/lib/python3.8/site-packages/nornir_cli/custom_commands/
/home/user/virtenvs/py3.8.4/lib/python3.8/site-packages/nornir_cli/custom_commands/
├── dhcp
│   ├── cmd_dhcp_snooping.py
│   └── templates
│       ├── dhcp_snooping.j2
│       └── disp_int.template
└── __init__.py

2 directories, 4 files
</code></pre></div>
<p>And my <code>nornir_cli</code> structure:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">nornir_cli:</label><label for="__tabbed_13_2">nornir_cli dhcp:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli
Usage: nornir_cli [OPTIONS] COMMAND [ARGS]...

  Nornir CLI

  Orchestrate your Inventory and start Tasks and Runbooks

Options:
  --version  Show the version and exit.
  --help     Show this message and exit.

Commands:
  dhcp
  nornir-f5        nornir_f5 plugin
  nornir-http      nornir_http plugin
  nornir-jinja2    nornir_jinja2 plugin
  nornir-napalm    nornir_napalm plugin
  nornir-netconf   nornir_netconf plugin
  nornir-netmiko   nornir_netmiko plugin
  nornir-paramiko  nornir_paramiko plugin
  nornir-pyez      nornir_pyez plugin
  nornir-pyxl      nornir_pyxl plugin
  nornir-routeros  nornir_routeros plugin
  nornir-scrapli   nornir_scrapli plugin
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli dhcp
Usage: nornir_cli dhcp [OPTIONS] COMMAND1 [ARGS]... [COMMAND2 [ARGS]...]...


Options:
  --help  Show this message and exit.

Commands:
  change_credentials  Change username and password
  dhcp_snooping       Configure dhcp snooping
  filter              Do simple or advanced filtering
  init                Initialize a Nornir
  print_result        print_result from nornir_utils
  show_inventory      Show current inventory
  write_file          Write_file, but not from nornir_utils
  write_result        Write `Result` object to file
  write_results       Write `Result` object to files
</code></pre></div>
</div>
</div>
</div>
<p>Ok, let's run the <code>dhcp_snooping</code> command on all access switches from our NetBox Inventory:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">get access switches:</label><label for="__tabbed_14_2">run dhcp_snooping:</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli dhcp init filter --hosts -s -a &#39;data__device_type__model__contains=S2320-28TP-EI-DC &amp; name__contains=access&#39;
[
    &quot;access_1&quot;
]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$ nornir_cli dhcp dhcp_snooping
access_1            : ok=1               changed=1               failed=0

OK      : 1
CHANGED : 1
FAILED  : 0
</code></pre></div>
</div>
</div>
</div>
<p>More detailed - <a href="https://timeforplanb123.github.io/nornir_cli/useful/#how-to-add-custom-nornir-runbook"><strong>How to add your custom Nornir runbook in <code>nornir_cli</code></strong></a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/timeforplanb123" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/timeforplanb1" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.instant"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>